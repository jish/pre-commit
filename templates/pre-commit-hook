#!/usr/bin/env ruby

if system("which rvm > /dev/null")
  if system("rvm default do gem list | grep pre-commit > /dev/null")
    cmd = "rvm default do ruby -rrubygems "
  else
    rvm_default = `rvm default do rvm current`
    abort("Please install pre-commit in your RVM default Ruby: #{rvm_default}")
  end
else
  cmd = "ruby -rrubygems "
end

cmd << %Q{-e "require 'pre-commit'; PreCommit.run"}

exit(system(cmd) ? 0 : 1)
