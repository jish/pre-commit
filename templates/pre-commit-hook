#!/usr/bin/env ruby

if system("which rvm > /dev/null")
  cmd = "rvm default do ruby -rrubygems "
else
  cmd = "ruby -rrubygems "
end

if !system("#{cmd} -rpre-commit -e '' 2> /dev/null")
  $stderr.puts "pre-commit: It looks like you've upgraded your ruby version."
  $stderr.puts "Please re-install the pre-commit gem: `gem install pre-commit`"
  exit(1)
end

cmd << %Q{-e "require 'pre-commit'; PreCommit.run"}

exit(system(cmd) ? 0 : 1)
